引出平衡二叉树: 给定一个数组 [1,2,3,4,5,6] 形成BST之后**变成一条向右倾斜的链表**。**查询效率不好**，丧失了树这种数据结构的优势。需要平衡二叉树来改进它。

# 概念

[![](https://cdn.nlark.com/yuque/0/2024/png/38953059/1710676176944-a0455ec4-675a-45f4-863f-4741ec7be140.png)](https://cdn.nlark.com/yuque/0/2024/png/38953059/1710676176944-a0455ec4-675a-45f4-863f-4741ec7be140.png)

# 旋转

## AVL左旋

### 示例一

[![](https://cdn.nlark.com/yuque/0/2024/png/38953059/1710716247100-6e7bd801-99f7-464b-83e5-bae1f19ea549.png)](https://cdn.nlark.com/yuque/0/2024/png/38953059/1710716247100-6e7bd801-99f7-464b-83e5-bae1f19ea549.png)

到10节点，发现左子树高度为0，右子树高度为2，以10节点为支点进行左旋。

[![](https://cdn.nlark.com/yuque/0/2024/png/38953059/1710716329278-e54d8b62-9e0d-44b8-b87a-a0690bb940bf.png)](https://cdn.nlark.com/yuque/0/2024/png/38953059/1710716329278-e54d8b62-9e0d-44b8-b87a-a0690bb940bf.png)

### 示例二

[![](https://cdn.nlark.com/yuque/0/2024/png/38953059/1710716531445-1cf5552e-0835-4e14-a1ee-a0217c2f4f6e.png)](https://cdn.nlark.com/yuque/0/2024/png/38953059/1710716531445-1cf5552e-0835-4e14-a1ee-a0217c2f4f6e.png)

[![](https://cdn.nlark.com/yuque/0/2024/png/38953059/1710716662606-d213998b-e964-4abf-8607-bc8a58b6dc9f.png)](https://cdn.nlark.com/yuque/0/2024/png/38953059/1710716662606-d213998b-e964-4abf-8607-bc8a58b6dc9f.png)

## AVL右旋

### 示例一

[![](https://cdn.nlark.com/yuque/0/2024/png/38953059/1710717693784-b7bd8f1b-e3d8-4a36-9d5f-8967f95b96d1.png)](https://cdn.nlark.com/yuque/0/2024/png/38953059/1710717693784-b7bd8f1b-e3d8-4a36-9d5f-8967f95b96d1.png)

[![](https://cdn.nlark.com/yuque/0/2024/png/38953059/1710717727905-e10b679d-3747-48e2-a2f4-d68e8e7f8ffa.png)](https://cdn.nlark.com/yuque/0/2024/png/38953059/1710717727905-e10b679d-3747-48e2-a2f4-d68e8e7f8ffa.png)

### 示例二

[![](https://cdn.nlark.com/yuque/0/2024/png/38953059/1710717790548-f719beff-ffdb-4bcb-9597-1495558a273a.png)](https://cdn.nlark.com/yuque/0/2024/png/38953059/1710717790548-f719beff-ffdb-4bcb-9597-1495558a273a.png)

[![](https://cdn.nlark.com/yuque/0/2024/png/38953059/1710717843128-114bbc77-f0e7-4f48-948a-63d0f87e8759.png)](https://cdn.nlark.com/yuque/0/2024/png/38953059/1710717843128-114bbc77-f0e7-4f48-948a-63d0f87e8759.png)

# AVL需要旋转的四种情况

节点插入之后，导致AVL不平衡，以下是4种可能会出现的情况。

## 左子树的左子树有节点插入

[![](https://cdn.nlark.com/yuque/0/2024/png/38953059/1710718033474-3c6f8b78-383c-4017-a1d9-0e7d2bb9699e.png)](https://cdn.nlark.com/yuque/0/2024/png/38953059/1710718033474-3c6f8b78-383c-4017-a1d9-0e7d2bb9699e.png)

[![](https://cdn.nlark.com/yuque/0/2024/png/38953059/1710718170298-a2a1d73b-3407-4927-991e-50b83c504cd2.png)](https://cdn.nlark.com/yuque/0/2024/png/38953059/1710718170298-a2a1d73b-3407-4927-991e-50b83c504cd2.png)

## 左子树的右子树有节点插入

[![](https://cdn.nlark.com/yuque/0/2024/png/38953059/1710718315122-ed4be01b-140e-4892-a308-2815dd549d99.png)](https://cdn.nlark.com/yuque/0/2024/png/38953059/1710718315122-ed4be01b-140e-4892-a308-2815dd549d99.png)

先进行局部左旋，也就是2，4，5，6的部分，然后进行整体的右旋。

[![](https://cdn.nlark.com/yuque/0/2024/png/38953059/1710718671463-6d092c5f-dda1-4854-84b3-7091ba7d4e63.png)](https://cdn.nlark.com/yuque/0/2024/png/38953059/1710718671463-6d092c5f-dda1-4854-84b3-7091ba7d4e63.png)

[![](https://cdn.nlark.com/yuque/0/2024/png/38953059/1710718695983-1c95274b-ee84-45b0-9425-358ad8c20725.png)](https://cdn.nlark.com/yuque/0/2024/png/38953059/1710718695983-1c95274b-ee84-45b0-9425-358ad8c20725.png)

## 右子树的右子树有节点插入

[![](https://cdn.nlark.com/yuque/0/2024/png/38953059/1710718972198-396f37c7-6db2-461c-b2b7-be4260ea2f4b.png)](https://cdn.nlark.com/yuque/0/2024/png/38953059/1710718972198-396f37c7-6db2-461c-b2b7-be4260ea2f4b.png)

[![](https://cdn.nlark.com/yuque/0/2024/png/38953059/1710718999426-f2fd0785-a7e3-4e92-890d-b3e71328e241.png)](https://cdn.nlark.com/yuque/0/2024/png/38953059/1710718999426-f2fd0785-a7e3-4e92-890d-b3e71328e241.png)

## 右子树的左子树有节点插入

[![](https://cdn.nlark.com/yuque/0/2024/png/38953059/1710719288359-0b164c7f-9416-4ac0-bae9-eea308d4a3df.png)](https://cdn.nlark.com/yuque/0/2024/png/38953059/1710719288359-0b164c7f-9416-4ac0-bae9-eea308d4a3df.png)

[![](https://cdn.nlark.com/yuque/0/2024/png/38953059/1710719364717-ef3ba80d-89b3-4aa4-9fb5-1b17de5d82f5.png)](https://cdn.nlark.com/yuque/0/2024/png/38953059/1710719364717-ef3ba80d-89b3-4aa4-9fb5-1b17de5d82f5.png)

[![](https://cdn.nlark.com/yuque/0/2024/png/38953059/1710719408507-cbc79717-f175-4814-b13d-d632511a1744.png)](https://cdn.nlark.com/yuque/0/2024/png/38953059/1710719408507-cbc79717-f175-4814-b13d-d632511a1744.png)

## 总结

[![](https://cdn.nlark.com/yuque/0/2024/png/38953059/1710719469280-09891408-eace-4ae2-b732-83907a0138f8.png)](https://cdn.nlark.com/yuque/0/2024/png/38953059/1710719469280-09891408-eace-4ae2-b732-83907a0138f8.png)

# 内容总结

[![](https://cdn.nlark.com/yuque/0/2024/png/38953059/1710720043623-f8ff22b6-679a-4417-8b17-f4e0906a83f1.png)](https://cdn.nlark.com/yuque/0/2024/png/38953059/1710720043623-f8ff22b6-679a-4417-8b17-f4e0906a83f1.png)

AVL树的左旋转、右旋转和双旋转都是为了维持树的平衡性。这些旋转都是为了确保任何节点的左右子树的高度差**不会超过1**，从而保持AVL树的平衡。这对于保证AVL树的高效操作（如搜索、插入和删除）至关重要。

1. **左旋转**（针对右-右不平衡）

- **情况**：**当一个节点的右子树比左子树高两个单位时**。
- **过程**：
- N（失衡节点）的右子节点 R 成为新的根节点。
- R的左子树成为 N的右子树。
- N成为 R的左子节点。
- **表示**：
- 旋转前：N --> R
- 旋转后：R --> N

1. **右旋转**（针对左-左不平衡）

- **情况**：**当一个节点的左子树比右子树高两个单位时**。
- **过程**：
- N（失衡节点）的左子节点 L 成为新的根节点。
- L的右子树成为 N的左子树。
- N成为 L的右子节点。
- **表示**：
- 旋转前：L --> N
- 旋转后：N --> L

1. **双旋转**（两种情况：左-右或右-左不平衡）

- **左-右双旋转**：
- **情况**：**节点的左子树的右子树导致不平衡**。
- **过程**：先对失衡节点的左子节点进行左旋转，然后对失衡节点进行右旋转。
- **表示**：
- 旋转前：L --> LR --> N
- 旋转后：LR --> N --> L
- **右-左双旋转**：
- **情况**：**节点的右子树的左子树导致不平衡**。
- **过程**：先对失衡节点的右子节点进行右旋转，然后对失衡节点进行左旋转。
- **表示**：
- 旋转前：N --> RL --> R
- 旋转后：RL --> R --> N

## 向左旋转

[![](https://cdn.nlark.com/yuque/0/2024/png/38953059/1710145128153-e2afa799-7fba-439b-98c3-16d7ad25f8a5.png)](https://cdn.nlark.com/yuque/0/2024/png/38953059/1710145128153-e2afa799-7fba-439b-98c3-16d7ad25f8a5.png)

### 代码实现

```Java
//左旋转方法
    private void leftRotate() {
        //创建新的结点，以当前根结点的值
        Node newNode = new Node(value);
        //把新的结点的左子树设置成当前结点的左子树
        newNode.left = left;
        //把新的结点的右子树设置成当前结点的右子树的左子树
        newNode.right = right.left;
        //把当前结点的值替换成右子结点的值
        value = right.value;
        //把当前结点的右子树设置成当前结点右子树的右子树
        right = right.right;
        //把当前结点的左子树(左子结点)设置成新的结点
        left = newNode;
    }
```

## 向右旋转

[![](https://cdn.nlark.com/yuque/0/2024/png/38953059/1710145168134-d74d6d76-7f59-4db5-a92f-0536177210e7.png)](https://cdn.nlark.com/yuque/0/2024/png/38953059/1710145168134-d74d6d76-7f59-4db5-a92f-0536177210e7.png)

### 代码实现

```Java
//右旋转
    private void rightRotate() {
        Node newNode = new Node(value);
        newNode.right = right;
        newNode.left = left.right;
        value = left.value;
        left = left.left;
        right = newNode;
    }
```

## 双旋转

在某些情况下，单旋转不能完成平衡二叉树的转换，所以使用双旋转。